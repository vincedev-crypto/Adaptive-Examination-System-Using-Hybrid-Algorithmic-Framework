<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Exam Results - ALGO</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .hidden { display: none; }
        #chartSection { margin-top: 2rem; }
        .performance-badge {
            font-size: 1.2rem;
            padding: 0.5rem 1rem;
        }
    </style>
</head>
<body class="bg-light">
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card shadow-sm border-0 p-5 text-center">
                    <div class="mb-4">
                        <div class="display-1 text-success">âœ“</div>
                        <h2 class="fw-bold">Exam Submitted!</h2>
                    </div>
                    <hr>
                    <div class="py-4">
                        <h4 class="text-secondary">Your Final Score</h4>
                        <h1 class="display-2 fw-bold text-primary" th:text="${score + ' / ' + total}"></h1>
                    </div>
                    
                    <!-- Random Forest Analytics Section -->
                    <div th:if="${analytics}" class="mt-4">
                        <h3>Performance Analysis (Random Forest)</h3>
                        <span class="badge performance-badge" 
                              th:classappend="${analytics.performanceCategory == 'Excellent' ? 'bg-success' : 
                                              analytics.performanceCategory == 'Good' ? 'bg-info' : 
                                              analytics.performanceCategory == 'Fair' ? 'bg-warning' : 'bg-danger'}"
                              th:text="${analytics.performanceCategory}"></span>
                        
                        <input type="hidden" id="tmScoreValue" th:value="${analytics.topicMastery}"/>
                        <input type="hidden" id="drScoreValue" th:value="${analytics.difficultyResilience}"/>
                        
                        <button id="renderRadarBtn" class="btn btn-success mt-3 btn-lg">
                            ðŸ“Š View Detailed Performance Chart
                        </button>
                        
                        <div id="chartSection" class="hidden mt-4">
                            <canvas id="radarChartCanvas" width="400" height="400"></canvas>
                        </div>
                    </div>
                    
                    <p class="text-muted mb-4 mt-4">
                        Great job! Your performance has been analyzed using Random Forest algorithms.
                    </p>
                    <a href="/student/dashboard" class="btn btn-outline-primary btn-lg">Back to Dashboard</a>
                </div>
            </div>
        </div>
    </div>
    
    <script src="/js/results-logic.js"></script>
</body>
</html>